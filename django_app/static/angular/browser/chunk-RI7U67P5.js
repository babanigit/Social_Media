import{Da as u,Ea as l,F as m,Fa as p,Ga as k,f as a,i as s,l as h,o as c}from"./chunk-YCZ53USQ.js";var w=class g{constructor(r,e){this.platformId=r;this.http=e}apiUrl="http://localhost:8000/api";getTokenFromCookieOrLocalStorage(){if(!u(this.platformId))return console.warn("localStorage and document.cookie are not available in this environment."),null;let r=localStorage.getItem("auth_token");if(r)return r;try{let e=document.cookie.split("; ");for(let t of e){let[o,n]=t.split("=");if(o.trim()==="auth_token")return decodeURIComponent(n)}}catch(e){console.error("[get-api-serV-error]:- Error retrieving auth token from cookies:",e)}return console.error("[get-api-serV-error cookie or local_storage]:- No auth token found. Authorization token missing or expired."),null}register(r){return this.http.post(this.apiUrl+"/register/",r)}login(r,e){let t={username:r,password:e};return this.http.post(this.apiUrl+"/login/",t,{withCredentials:!0})}getLoggedInUser(r=1){let e=this.getTokenFromCookieOrLocalStorage();if(!e)return a({error:{error:"token not found"}});let t=new l({Authorization:`Token ${e}`}),o=new p().set("page",r.toString());return this.http.get(this.apiUrl+"/user/",{headers:t,params:o}).pipe(s(n=>{throw console.error("[get-api-serV-error]:- Error loading logged in User :",n),n}))}getTweets(r=1,e=10,t,o=!1){let n=new p().set("page",r.toString()).set("per_page",e.toString());return t&&(n=n.set("user_id",t.toString())),o&&(n=n.set("following_only","true")),this.http.get(this.apiUrl+"/tweets/",{params:n}).pipe(s(i=>{throw console.error("[get-api-serV-error]:- Error loading get Tweets :",i),i}))}getAllUsers(r=1,e=10,t,o=!1){let n=new p().set("page",r.toString()).set("per_page",e.toString());return t&&(n=n.set("user_id",t.toString())),o&&(n=n.set("following_only","true")),this.http.get(this.apiUrl+"/getUsers/",{params:n}).pipe(s(i=>{throw console.error("[get-api-serV-error]:- Error loading get Tweets :",i),i}))}getTweetById(r){let e=this.getTokenFromCookieOrLocalStorage();if(!e)return a({error:{error:"token not found"}});let t=new l({Authorization:`Token ${e}`});return this.http.get(`${this.apiUrl}/tweet/${r}/tweet`).pipe(s(o=>{throw console.error("[get-api-serV-error get tweet by id]:- ",o),o}))}createTweet(r,e){let t=new FormData;t.append("content",r),e&&t.append("image",e,e.name);let o=this.getTokenFromCookieOrLocalStorage();if(!o)return a({error:{error:"token not found"}});let n=new l({Authorization:`Token ${o}`});return this.http.post(this.apiUrl+"/tweets/create/",t,{headers:n}).pipe(s(i=>{throw console.error("[get-api-serV-error]:- Error loading create Tweet :",i),i}))}likeTweet(r){let e=this.getTokenFromCookieOrLocalStorage();if(!e)return a({error:{error:"token not found"}});let t=new l({Authorization:`Token ${e}`});return this.http.post(`${this.apiUrl}/tweets/${r}/like/`,null,{headers:t}).pipe(s(o=>{throw console.error("[get-api-serV-error]:- ",o),o}))}createComment(r,e){let t=this.getTokenFromCookieOrLocalStorage();if(!t)return a({error:{error:"token not found"}});let o=new l({Authorization:`Token ${t}`});return this.http.post(`${this.apiUrl}/tweets/${r}/getPostPutDeleteComment/`,e,{headers:o}).pipe(s(n=>{throw console.error("[get-api-serV-error]:- ",n),n}))}getTweetComments(r){let e=`${this.apiUrl}/tweets/${r}/getPostPutDeleteComment/`;return this.http.get(e).pipe(s(t=>{throw console.error("[get-api-serV-error get tweet comments]:- ",t),t}))}getCommentById(r){let e=`${this.apiUrl}/comments/${r}/`;return this.http.get(e).pipe(s(t=>{throw console.error("[get-api-serV-error get comment by id]:- ",t),t}))}likeComment(r){let e=this.getTokenFromCookieOrLocalStorage();if(!e)return a({error:{error:"token not found"}});let t=new l({Authorization:`Token ${e}`});return this.http.post(`${this.apiUrl}/tweets/${r}/likeComment/`,null,{headers:t}).pipe(s(o=>{throw console.error("[get-api-serV-error]:- ",o),o}))}dislikeComment(r){let e=this.getTokenFromCookieOrLocalStorage();if(!e)return a({error:{error:"token not found"}});let t=new l({Authorization:`Token ${e}`});return this.http.post(`${this.apiUrl}/tweets/${r}/dislikeComments/`,null,{headers:t}).pipe(s(o=>{throw console.error("[get-api-serV-error]:- Error loading like tweet :",o),o}))}static \u0275fac=function(e){return new(e||g)(c(m),c(k))};static \u0275prov=h({token:g,factory:g.\u0275fac,providedIn:"root"})};export{w as a};
